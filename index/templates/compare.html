{% extends "base.html" %}
{% block content %}
{% load static %}

<section id="pagetopbar">
    <div class="container d-flex justify-content-center justify-content-md-between">
         <span>
            {{song.song_title}}
            {% if songFeatArtist|length >= 1 %}
                ( Feat. 
                {% for feat in songFeatArtist%}
                <span>{{ feat.artist.artist_name }}</span>
                {% if not forloop.last %},{% endif %}
                {% endfor %}
                )
                {% else %}
                <span>{{ songFeatArtist.artist.artist_name }}</span>
            {% endif %}
        </span>
    </div>
</section>

<section id="pageinfo" class="pageinfo">
    <div class="container">
        <div class="pageheader">
            <div class="row align-items-center">
                <div class="col-lg-3 col-md-4 col-sm-12 mb-3 mb-md-0">
                    <div class="cover">
                        {% if song.song_album.album_image %}
                            <img class="artwork" src="/{{ song.song_album.album_image }}" alt="{{ song.song_album.album_title }}">
                        {% else %}
                            <div class="cover-placeholder">
                                <svg width="100" height="100" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <circle cx="12" cy="12" r="10"/>
                                    <path d="M6 12c0-1.7.7-3.2 1.8-4.2"/>
                                    <circle cx="12" cy="12" r="2"/>
                                    <path d="M18 12c0 1.7-.7 3.2-1.8 4.2"/>
                                </svg>
                            </div>
                        {% endif %}
                    </div>
                </div>
                <div class="col-lg-9 col-md-8 col-sm-12">
                    <p class="page-title">{{song}}</p>
                    <p>
                        <a href="{% url 'musicapp:album' %}{{ song.song_album.album_uuid}}">{{song.song_album.album_title}}</a>
                    </p>
                    <span class="page-albumartist">
                        <a href="{% url 'musicapp:artist' %}{{ songMainArtist.artist.artist_uuid }}/">{{ songMainArtist.artist.artist_name }}</a>
                    </span>
                    {% for feat in songFeatArtist%}
                        <span class="page-albumartist">
                            <a href="{% url 'musicapp:artist' %}{{ feat.artist.artist_uuid }}/"> {{ feat.artist.artist_name }}</a>
                        </span>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
</section>


<!-- ======= Song compare Section ======= -->
<section id="compare" class="compare">
    <div class="container">

    <div class="row">
        <div class="col-lg-6 col-md-6">
            <div class="song">
                <span class="samplingbadge">샘플링 곡</span>
                <div class="media-wrapper">
                    {% if song.song_link %}
                        <iframe 
                        id="sampling" 
                        src="https://www.youtube.com/embed/{{song.song_link}}?enablejsapi=1&origin={{ request.scheme }}://{{ request.get_host }}"
                        ></iframe>
                    {% else %}
                        <div class="media-placeholder">영상이 없습니다.</div>
                    {% endif %}
                </div>
                <div class="time">
                    Sample appear at 
                    {% for timestamp in sampling_song_timestamp%}
                    <span class="time-highlight" data-player="sampling" data-timestamp="{{timestamp}}">{{timestamp}}</span>
                    {% if not forloop.last %},{% endif %}
                    {% endfor %}
                </div>
                <h3 class="song-title">{{song.song_title}}</h3>
                {% if songFeatArtist|length >= 1 %}
                <span class="artist-name">
                    <a href="{% url 'musicapp:artist' %}{{ songMainArtist.artist.artist_uuid }}/">{{songMainArtist.artist.artist_name}}</a>
                </span>
                Feat.
                {% for feat in songFeatArtist%}
                <span class="artist-name">
                    <a href="{% url 'musicapp:artist' %}{{ feat.artist.artist_uuid }}/">{{ feat.artist.artist_name }}</a>
                </span>
                {% if not forloop.last %},{% endif %}
                {% endfor %}
                {% else %}
                <span class="artist-name">
                    <a href="{% url 'musicapp:artist' %}{{ songMainArtist.artist.artist_uuid }}/">{{songMainArtist.artist.artist_name}}</a>
                </span>
                <span class="artist-name">
                    <a href="{% url 'musicapp:artist' %}{{ songFeatArtist.artist.artist.uuid }}/">{{ songFeatArtist.artist.artist_name }}</a>
                </span>
                {% endif %}
                <p class="album-title">
                    <a href="{% url 'musicapp:album' %}{{ song.song_album.album_uuid}}">{{song.song_album.album_title}}</a>
                </p>
                <p class="producer-name">Produced by {{song.song_producer}}</p>
                
            </div>
        </div>
        <div class="col-lg-6 col-md-6">
            <div class="song">
                <span class="originalbadge">원곡</span>
                <div class="media-wrapper">
                    {% if sample.original_song.song_link %}
                        <iframe 
                        id="original" 
                        src="https://www.youtube.com/embed/{{sample.original_song.song_link}}?enablejsapi=1&origin={{ request.scheme }}://{{ request.get_host }}"
                        ></iframe>
                    {% else %}
                        <div class="media-placeholder">영상이 없습니다.</div>
                    {% endif %}
                </div>
                <div class="time">
                    Sample appear at 
                    {% for timestamp in original_song_timestamp%}
                    <span class="time-highlight" data-player="original" data-timestamp="{{timestamp}}">{{timestamp}}</span>
                    {% if not forloop.last %},{% endif %}
                    {% endfor %}
                </div>
                <h3 class="song-title">{{sample.original_song.song_title}}</h3>
                
                <span class="artist-name">
                    <a href="{% url 'musicapp:artist' %}{{ sampleMainArtist.artist.artist_uuid }}/">{{ sampleMainArtist.artist.artist_name }}</a>
                </span>

                {% if sample.original_song.song_album.album_title != 'Unknown' %}  
                <p class="album-title">
                    <a href="{% url 'musicapp:album' %}{{ sample.original_song.song_album.album_uuid }}/">{{ sample.original_song.song_album }}</a>
                </p>
                {% endif %}

                {% if song.sample_producer %}
                <p class="producer-name">Produced by {{song.sample_producer}}</p>
                {% endif %}
                
                {% if song.sample_contributor %}
                <p class="contributor">Contributed by {{song.sample_contributor}}</p>
                {% endif %}
            </div>
        </div>
    </div>

    </div>
</section><!-- End Song compare Section -->

<script src="https://www.youtube.com/iframe_api"></script>

{% endblock %}